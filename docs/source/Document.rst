Document
========

Объект является базовым объектом для всех типов документов.
Обладает базовым набором свойств и методов, которые также работают для всех производных типов документов.


.. rubric:: Свойства

:Type:
    **строка, чтение** - тип документа

:TypeNamedId:
    **строка, чтение** - строковый идентификатор типа документа

:DocumentFunction:
    **строка, чтение** - функция документа

:Version:
    **строка, чтение** - информация о версии XSD схемы, в соотвествии с которой сформирован документ

:Organization:
    :doc:`Organization <Organization>` **, чтение** - организация, которая отправила исходящий документ, либо получила входящий документ

:OrganizationId:
    **строка, чтение** - идентификатор организации, которой принадлежит документ

:Counteragent:
    :doc:`Counteragent <Counteragent>` **, чтение** - контрагент документа

:DocumentId:
    **строка, чтение** - идентификатор документа

:OneSDocumentId:
    **строка, чтение** - идентификатор документа в 1С

:PackageId:
    **строка, чтение** - идентификатор пакета

:Direction:
    **строка, чтение** - направление документа

:Department:
    :doc:`Department <Department>` **, чтение** - подразделение организации, к которому привязан документ

:FromDepartment:
    :doc:`Department <Department>` **, чтение** - подразделение организации, из которого был отправлен документ

:ToDepartment:
    :doc:`Department <Department>` **, чтение** - подразделение организации, в которое был отправлен документ

:Timestamp:
    **дата и время, чтение** - дата и время отправки документа (в текущем часовом поясе)

:TimestampSeconds:
    **число, чтение** - дата и время отправки документа в секундах

:DocumentDate:
    **дата, чтение** - дата документа

:DocumentNumber:
    **строка, чтение** - номер документа

:Title:
    **строка, чтение** - название документа, например, "Счет-фактура №123 от 20.02.18"

:FileName:
    **строка, чтение** - имя файла документа, с которым он загружался в Диадок

:PathURL:
    **строка, чтение** - URL документа, по которому он доступен в web-интерфейсе

:InitialDocumentIds:
    :doc:`Коллекция  <Collection>` **строк, чтение** - коллекция идентификаторов документов, на который ссылается данный документ (т.е. документы, которые по отношению к данному документы являются "родительскими"

:SubordinateDocumentIds:
    :doc:`Коллекция <Collection>` **строк, чтение** - коллекция идентификаторов документов, которые ссылаются на данный документ (т.е. документы, которые по отношению к данному документу являются "дочерними")

:CustomDocumentId:
    **строка, чтение** - идентификатор документа, определяемый внешней системой

:RouteId:
    **строка, чтение** - идентификатор маршрута согласования, на котором находится документ

:WorkflowId:
    **число, чтение** - идентификатор типа документооборота

:Status:
    **строка, чтение** - текущий статус документа в Диадоке. Перечень возможных значений зависит от типа документа и описан в спецификации соответствующего производного объекта

:ResolutionStatus:
    :doc:`ResolutionStatus <ResolutionStatus>` **, чтение** - текущий статус согласования документа

:Resolutions:
    :doc:`Коллекция <Collection>` **объектов** :doc:`Resolution <Resolution>` **, чтение** - история согласования документа

:ResolutionRequests:
    :doc:`Коллекция <Collection>` **объектов** :doc:`ResolutionRequest <ResolutionRequest>` **, чтение** - коллекция запросов на согласование

:ResolutionRequestDenials:
    :doc:`Коллекция <Collection>` **объектов** :doc:`ResolutionRequestDenial <ResolutionRequestDenial>` **, чтение** - коллекция объектов отмены запросов на согласование

:RevocationStatus:
    **строка, чтение** - статус аннулирования документа

:SenderSignatureStatus:
    **строка, чтение** - статус проверки ЭЦП отправителя

:RecipientResponseStatus:
    **строка, чтение** - отвечает за состояние ответного действия со стороны получателя документа

:RoamingNotificationStatus:
    **строка, чтение** - статус передачи документа через роуминг

:RoamingNotificationStatusDescription:
    **строка, чтение** - описание статуса передачи документа через роуминг.

:CustomData:
    :doc:`Коллекция <Collection>` **объектов** :doc:`CustomDataItem <CustomDataItem>` **, чтение** - коллекция элементов "ключ-значение"

:Metadata:
    :doc:`Коллекция <Collection>` **объектов** :doc:`MetadataItem <MetadataItem>` **, чтение** - коллекция метаданных

:RecipientReceiptMetadata:
    :doc:`RecipientReceiptMetadata <RecipientReceiptMetadata>` **, чтение** - метаданные извещения о получении документа получателем

:ConfirmationMetadata:
    :doc:`ConfirmationMetadata <ConfirmationMetadata>` **, чтение** - метаданные подтверждения оператором отправки/получения документа или служебного документа

:AmendmentRequestMetadata:
    :doc:`AmendmentRequestMetadata <AmendmentRequestMetadata>` **, чтение** - метаданные уведомления об уточнении

:IsDeleted:
    **булево, чтение** - флаг, показывающий, был ли удален данный документ

:IsTest:
    **булево, чтение** - флаг, показывающий, что документ является тестовым и не имеет юридической силы

:HasCustomPrintForm:
    **булево, чтение** - флаг, показывающий, что документ имеет нестандартную печатную форму

:IsLockedPackage:
    **булево, чтение** - флаг, показывающий, что документ является частью нередактируемого пакета

:IsRead:
    **булево, чтение** - флаг, показывающий, что документ был прочитан сотрудником организации

:IsEncryptedContent:
    **булево, чтение** - флаг, показывающий, что содержимое документа зашифровано


.. rubric:: Методы

* :doc:`SaveContent <SaveContent>` сохраняет титул отправителя на диск
* :doc:`SaveBuyerContent <SaveBuyerContent>` сохраняет титул получателя на диск
* :doc:`SaveAllContent <SaveAllContent>` сохраняет все файлы, относящиеся к документу (в т.ч. электронные подписи), в указанную директорию
* :doc:`SaveAllContentAsync <SaveAllContentAsync>` асинхронно сохраняет все файлы, относящиеся к документу (в т.ч. электронные подписи), в указанную директорию
* :doc:`SaveAllContentZip <SaveAllContentZip>` формирует архив, содержащий все файлы, относящиеся к документу (в т.ч. электронные подписи), и сохраняет его в указанную директорию
* :doc:`SaveAllContentZipAsync <SaveAllContentZipAsync>` асинхронно формирует архив, содержащий все файлы, относящиеся к документу (в т.ч. электронные подписи), и сохраняет его в указанную директорию
* :doc:`GetDynamicContent <Document_GetDynamicContent>` возвращает представление контента титула документа
* :doc:`GetBase64Content <Document_GetBase64Content>` возвращает контент одного из титулов документа в base64
* :doc:`GetBase64ContentAsync <Document_GetBase64ContentAsync>` асинхронно возвращает контента одного из титулов документа в base64
* :doc:`GetBase64Signature <Document_GetBase64Signature>` возвращает подпись одного из титулов документа в base64
* :doc:`GetSenderSignature <GetSenderSignature>` возвращает представление подписи титула отправителя
* :doc:`GetRecipientSignature <GetRecipientSignature>` возвращает представление подписи титула получателя
* :doc:`GetComment <GetComment>` возвращает комментарий к документу, заданный при отправке
* :doc:`GetAnyComment <GetAnyComment>` возвращает комментарий определённого типа, связанный с документом
* :doc:`Move <Move>` перемещает документ в указанное подразделение
* :doc:`Delete <Delete>` помечает документ как удаленный
* :doc:`Approve <Approve>` ставит признак согласования документа
* :doc:`Disapprove <Disapprove>` ставит признак отказа в согласовании документа
* :doc:`SetOneSDocumentId <SetOneSDocumentId>` присваивает документу дополнительный идентификатор
* :doc:`ReSetOneSDocumentId <ReSetOneSDocumentId>` сбрасывает дополнительный идентификатор
* :doc:`AddSubordinateOneSDocumentId <AddSubordinateOneSDocumentId-(Document)>` добавляет документу дополнительный идентификатор как подчинённый
* :doc:`RemoveSubordinateOneSDocumentId <RemoveSubordinateOneSDocumentId>` удаляет дополнительный подчинённый идентификатор
* :doc:`CreateResolutionRequestTask <CreateResolutionRequestTask>` создает задание для отправки запроса на согласование
* :doc:`GetPrintForm <GetPrintForm>` получает печатную форму документа в формате pdf
* :doc:`GetDocumentPackage <GetDocumentPackage>` возвращает сообщение, в котором находится документ
* :doc:`CreateReplySendTask <CreateReplySendTask-(Document)>` создает задание на выполнение ответного действия с документом
* :doc:`CreateReplySendTask2 <CreateReplySendTask2>` создает задание на выполнение ответного действия с документом
* :doc:`CreateOutDocumentSignTask <CreateOutDocumentSignTask-(Document)>` создает задание на подписание и отправку исходящего документа с отложенной отправкой
* :doc:`MarkAsRead <MarkAsRead>` помечает, что документ как прочитанный
* :doc:`CreateCustomDataPatchTask <CreateCustomDataPatchTask>` создает задание на редактирование коллекции CustomData
* :doc:`AssignToResolutionRoute <AssignToResolutionRoute>` ставит документ на маршрут согласования
* :doc:`RemoveFromResolutionRoute <RemoveFromResolutionRoute>` снимает документ с маршрута согласования


.. rubric:: Дополнительная информация

=========================== ===================
Значение свойства Direction Описание
=========================== ===================
Inbound                     входящий документ
Outbound                    исходящий документ
Internal                    внутренний документ
=========================== ===================


================================== =====================================================================
Значение свойства RevocationStatus Описание
================================== =====================================================================
RevocationStatusNone               документ не аннулирован, и не было предложений об аннулировании
RevocationIsRequestedByMe          отправлено исходящее предложение об аннулировании документа
RequestsMyRevocation               получено входящее предложение об аннулировании документа
RevocationAccepted                 документ аннулирован
RevocationRejected                 получен или отправлен отказ от предложения об аннулировании документа
UnknownRevocationStatus            неизвестный статус аннулирования документа
================================== =====================================================================


=========================================== =========================================================================
Значение свойства RoamingNotificationStatus Описание
=========================================== =========================================================================
RoamingNotificationStatusNone               документ не роуминговый или документ без подтверждения доставки в роуминг
RoamingNotificationStatusSuccess            документ с подтверждением успешной доставки в роуминг
RoamingNotificationStatusError              документ с ошибкой доставки в роуминг
UnknownRoamingNotificationStatus            неизвестный роуминговый статус документа
=========================================== =========================================================================


======================================= =========================================
Значение свойства SenderSignatureStatus Описание
======================================= =========================================
WaitingForSenderSignature               ожидается подпись отправителя
SenderSignatureUnchecked                подпись отправителя еще не проверена
SenderSignatureCheckedAndValid          подпись отправителя проверена и валидна
SenderSignatureCheckedAndInvalid        подпись отправителя проверена и невалидна
UnknownSenderSignatureStatus            неизвестный статус проверки подписи
======================================= =========================================


========================================= ==================================================
Значение свойства RecipientResponseStatus Описание
========================================= ==================================================
RecipientResponseStatusUnknown            неизвестный статус ответного действия
RecipientResponseStatusNotAcceptable      ответного действия не требуется
WaitingForRecipientSignature              ожидается ответное действие получателя
WithRecipientSignature                    получатель подписал документ (ответный титул)
RecipientSignatureRequestRejected         получатель отказал в подписи
InvalidRecipientSignature                 получатель подписал документ некорректной подписью
========================================= ==================================================


============================================================================== ======================================================
Объекты, производные от Document                                               Описание
============================================================================== ======================================================
:doc:`Contract <Contract>`                                                     договор
:doc:`Invoice <Invoice>`                                                       счет-фактура
:doc:`InvoiceRevision <InvoiceRevision>`                                       исправление счета-фактуры
:doc:`InvoiceCorrection <InvoiceCorrection>`                                   корректировочный счет-фактура
:doc:`InvoiceCorrectionRevision <InvoiceCorrectionRevision>`                   исправление корректировочного счета-фактуры
:doc:`Nonformalized <Nonformalized>`                                           неформализованный документ
:doc:`NonformalizedAcceptanceCertificate <NonformalizedAcceptanceCertificate>` акт о выполнении работ в неформализованном виде
:doc:`NonformalizedTorg12 <NonformalizedTorg12>`                               ТОРГ-12 в неформализованном виде
:doc:`NonformalizedProformaInvoice <NonformalizedProformaInvoice>`             счет на оплату
:doc:`XmlAcceptanceCertificate <XmlAcceptanceCertificate>`                     акт о выполнении работ в формализованном виде
:doc:`XmlTorg12 <XmlTorg12>`                                                   ТОРГ-12 в формализованном виде
:doc:`Utd <Utd>`                                                               универсальный передаточный документ
:doc:`UtdRevision <UtdRevision>`                                               исправление универсального передаточного документа
:doc:`Ucd <Ucd>`                                                               универсальный корректировочный документ
:doc:`UcdRevision <UcdRevision>`                                               исправление универсального корректировочного документа
:doc:`BaseDocument <BaseDocument>`                                             документ "любого типа"
============================================================================== ======================================================
