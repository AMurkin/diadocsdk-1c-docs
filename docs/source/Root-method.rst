DiadocInvoiceAPI
================


Объект DiadocInvoiceAPI предназначен для:

* управления параметрами подключения к серверу Диадок
* авторизации на сервере Диадок


.. rubric:: Свойства

:ApiClientId:
  **Строка, чтение/запись** - ключ разработчика

:ServerUrl:
  **Строка, чтение/запись** - URL сервера Диадок

:ProxyMode:
  **Строка, чтение/запись** - режим использования прокси-сервера

:ProxySettings:
  :doc:`ProxySettings <ProxySettings>` **, чтение** - настройки прокси-сервера


.. rubric:: Методы

+--------------------------------------+----------------------------------------+
|:func:`.CreateConnectionByCertificate`|:func:`.TestConnection`                 |
+--------------------------------------+----------------------------------------+
|:func:`.CreateConnectionByLogin`      |:func:`.TestConnection2`                |
+--------------------------------------+----------------------------------------+
|:func:`.GetPersonalCertificates`      |:func:`.VerifyThatUserHasAccessToAnyBox`|
+--------------------------------------+----------------------------------------+
|:func:`.GetVersion`                   |                                        |
+--------------------------------------+----------------------------------------+


.. function:: DiadocInvoiceAPI.CreateConnectionByCertificate(Thumbprint[, Pin])

  :Thumbprint: ``Строка`` Отпечаток сертификата
  :Pin:        ``Строка`` Пин-код или пароль от контейнера сертификата

  Возвращает :doc:`объект логического соединения <Connection>`, созданного по сертификату с указанным отпечатком.
  Поиск сертификата происходит в хранилище `Личное` пользователя и, если там сертиифкат не найден - в хранилище `Личное` машины.
  Если *Pin* не задан, то будет использоваться пин-код/пароль, запомненный в крипто-провайдере или пустая строка



.. function:: DiadocInvoiceAPI.CreateConnectionByLogin(Login, Password)

  :Login:    ``Строка`` Логин пользователя
  :Password: ``Строка`` Пароль пользователя

  Возвращает :doc:`объект логического соединения <Connection>`, созданного по логину и паролю



.. function:: DiadocInvoiceAPI.GetPersonalCertificates(UserStore=TRUE)

  :UsePersonalStore: ``Булево`` Поиск производится в хранилище пользователя

  Возвращает :doc:`коллекцию <Collection>` :doc:`сертификатов <PersonalCertificate>`, установленных в хранилище `Личное`. Поиск может производиться в хранилище пользователя или машины



.. function:: DiadocInvoiceAPI.GetVersion()

  Возвращает строку с версией используемой компоненты



.. function:: DiadocInvoiceAPI.TestConnection()

  Проверяет возможность соединения с сервером Диадока, используя установленные параметры. Возвращает булево значение

  .. deprecated:: 5.26.3
      Используйте :func:`.TestConnection2`



.. function:: DiadocInvoiceAPI.TestConnection2()

  Возвращает :doc:`объект с результатами проверки соединения <TestConnectionResult>` с сервером Диадока, используя установленные параметры

  .. versionadded:: 5.26.3



.. function:: DiadocInvoiceAPI.VerifyThatUserHasAccessToAnyBox(Thumbprint)

  :Thumbprint: ``Строка`` Отпечаток сертификата

  Возвращает булевый признак, означающий есть ли у пользователя с указанным сертификатом доступ к какой-либо организации в Диадок.



.. rubric:: Дополнительная информация

==================== ================================================================
Значение *ProxyMode* Описание
==================== ================================================================
NoProxy              не использовать прокси-сервер при подключении
UseProxy             использовать настройки прокси-сервера, указанные в ProxySettings
UseDefaultProxy      использовать прокси-сервер по умолчанию
==================== ================================================================


.. seealso:: :doc:`How-auth`
